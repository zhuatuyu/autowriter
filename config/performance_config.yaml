# =============================================================================
# 绩效分析报告业务配置文件
# 通过修改此文件可以驱动整个业务流程，无需修改代码
# =============================================================================

# 领域基本信息
domain_info:
  name: "绩效分析报告"
  description: "财政项目绩效评价报告生成系统"
  version: "1.0.0"

# =============================================================================
# 知识图谱领域配置 - 用于知识图谱构建和推理
# =============================================================================
knowledge_graph:
  entity_types:
    政策法规:
      - 法规名称
      - 适用范围
      - 发布机构
      - 生效时间
      - 关键条款
      - 引用标准
    方法论:
      - 方法名称
      - 适用场景
      - 步骤清单
      - 评价模型
      - 样例
    最佳实践:
      - 实践名称
      - 行业场景
      - 实施要点
      - 达成效果
      - 参考报告ID
    项目案例:
      - 项目名称
      - 地区
      - 年度
      - 资金规模
      - 主要内容
      - 产出
      - 效益
  relation_types:
    - 适用于
    - 引用
    - 来源于
    - 验证了
    - 属于维度
    - 支撑指标
    - 冲突于
    - 对齐于
  synonyms:
    绩效目标: [目标设定, 目标体系]
    产出指标: [数量指标, 质量指标, 时效指标]
  tags:
    policy: [政策法规]
    method: [方法论]
    best_practice: [最佳实践]
    case: [项目案例]
    metric: [指标体系, 具体指标]
  
  # 关系类型定义
  relation_types:
    - "包含"
    - "属于"
    - "适用于"
    - "遵循"
    - "参考"
    - "导致"
    - "解决"
    - "改进"
    - "关联"
    - "影响"

# =============================================================================
# 报告结构配置 - 用于架构师设计报告结构
# =============================================================================
report_structure:
  # 标准章节配置
  sections:
    - title: "一、项目概述"
      key: "overview"
      prompt_template: |
        请围绕以下方面详细描述项目概况：
        1. 项目立项背景及目的、项目主要内容
        2. 资金投入和使用情况
        3. 项目实施情况
        3. 项目组织管理
        4. 项目绩效目标：通过知识库搜索绩效目标表复制相关内容，务必以表格形式展示、为了实现绩效目标制定的制度、采取的措施等
      keywords:
        - "项目背景与目标"
        - "资金与预算"
        - "实施方案"
        - "组织管理"
        - "绩效目标"
        - "制定的制度"
        - "采取的措施"
    
    - title: "二、综合绩效评价结论"
      key: "conclusion"
      prompt_template: |
        请基于对项目决策、过程、产出和效益四个维度的全面绩效分析，给出项目的综合评价结论。
        必须直接依据 metric_analysis_table.md 的评分结果（score 与 opinion），进行归纳与总结。
        应包含项目总得分、评价等级，并务必以表格形式清晰展示各一级指标（决策、过程、产出、效益）的计划分值、实际得分和得分率；
        同时按评分项简要引用关键评价意见（opinion）的要点，确保结论与指标结果一一对应。
      keywords:
        - "效果与成效"
        - "评价指标"
        - "绩效得分"
    
    - title: "三、主要成效及经验"
      key: "achievements"
      prompt_template: |
        请详细总结项目实施过程中所取得的各项主要成效，需结合具体数据和事实进行阐述。
        同时，提炼出项目在政策执行、资金管理、部门协同、服务优化等方面可供其他地区或类似项目借鉴的成功经验和有效做法
      keywords:
        - "效果与成效"
        - "实施方案"
        - "成功案例"
    
    - title: "四、存在的问题和原因分析"
      key: "problems"
      prompt_template: |
        请根据调研（如问卷调查、访谈）和数据分析，客观、准确地指出项目在实施过程中存在的主要问题。
        必须结合指标评分结果中涉及扣分的指标与评价意见（opinion），逐项分析扣分原因、数据依据与影响范围；
        对于每个识别出的问题，都应深入剖析其产生的内外部原因，并指明其与具体指标扣分项之间的对应关系
      keywords:
        - "风险与挑战"
        - "问题分析"
        - "原因调查"
    
    - title: "五、改进建议"
      key: "suggestions"
      prompt_template: |
        针对在'存在的问题和原因分析'部分指出的各项主要问题，请逐条提出具体的、有针对性的、可操作的改进建议。
        建议应明确改进方向、责任主体和预期效果
      keywords:
        - "改进措施"
        - "最佳实践"
        - "政策建议"

# =============================================================================
# 研究方向配置 - 用于综合研究Action
# =============================================================================
research_settings:
  decomposition_nums: 2   # 研究问题分解数量
  url_per_query: 3       # 每个问题抓取URL数量

research_directions:
  # 网络研究增强查询模板
  enhancement_queries:
    - "最佳实践案例和成功经验"
    - "常见问题和风险因素"
    - "绩效评价指标和评价方法"
    - "相关的政策法规和标准规范"
  
  # 分解研究问题的维度
  decomposition_dimensions:
    - "决策维度分析"
    - "过程维度分析" 
    - "产出维度分析"
    - "效益维度分析"
  
  # 证据收集类别
  evidence_categories:
    - category: "项目基本信息"
      keywords: ["项目名称", "项目背景", "主要目标"]
    - category: "资金预算"
      keywords: ["预算金额", "资金来源", "支出明细"]
    - category: "实施内容"
      keywords: ["实施方案", "技术措施", "管理流程"]
    - category: "绩效指标"
      keywords: ["评价指标", "成果产出", "效益分析"]

  # 默认备用关键词（当LLM生成失败时使用）
  fallback_keywords:
    - category: "项目基本信息"
      keywords: ["项目名称", "项目背景", "主要目标"]
    - category: "资金预算"
      keywords: ["预算金额", "资金来源", "支出明细"]
    - category: "实施内容"
      keywords: ["实施方案", "技术措施", "管理流程"]
    - category: "绩效指标"
      keywords: ["评价指标", "成果产出", "效益分析"]

  # 证据摘要关键词映射（用于智能提取检索指导）
  evidence_keyword_mapping:
    预算资金数据:
      keywords: ["预算", "资金", "金额", "支出", "拨款"]
    目标指标设定:
      keywords: ["目标", "指标", "计划", "预期", "设定"]
    实施管理措施:
      keywords: ["实施", "管理", "措施", "方案", "流程"]
    实施效果数据:
      keywords: ["效果", "成果", "成效", "数据", "统计"]

  # Architect设计查询模板
  design_queries:
    - "报告结构 章节划分 目录大纲"
    - "关键指标 评价指标 绩效指标"
    - "数据分析 技术方案 实施方法"
    - "风险挑战 问题建议 解决方案"

  # 研究阶段与检索意图/关键词对齐--精简版
  stages:
    - id: find_cases
      title: "寻找类似项目和网络案例"
      intent_hint: ["case","metric"]   # 偏向向量+少量KG
      stage_queries:
        - "类似项目 案例 绩效评价 报告"
        - "同行业 同地区 绩效案例 指标体系"

    - id: metrics_research
      title: "构建指标体系的前期研究"
      intent_hint: ["metric","method","policy"]  # 指标→方法→政策，必要时用KG
      stage_queries:
        - "绩效指标 设计 方法 评价类型"
        - "指标计分规则 评价要点 最佳实践"

    - id: core_issues
      title: "发现项目核心问题和要点"
      intent_hint: ["metric","case","policy"]  # 对齐“问题与扣分项”
      stage_queries:
        - "常见问题 风险因素 资金使用 合规"
        - "质量控制 达标率 问题整改"




# =============================================================================
# 评价标准配置 - 用于写作专家评价和打分
# =============================================================================
evaluation_standards:
  # 评价等级定义
  score_levels:
    优秀:
      min: 90
      max: 100
      description: "项目实施非常成功，各项指标均达到或超过预期"
    良好:
      min: 80
      max: 89
      description: "项目实施比较成功，主要指标达到预期"
    一般:
      min: 70
      max: 79
      description: "项目基本完成，但部分指标有待改进"
    及格:
      min: 60
      max: 69
      description: "项目勉强完成，存在较多问题"
    较差:
      min: 0
      max: 59
      description: "项目实施效果不佳，需要重大改进"
  
  # 四个维度权重配置
  dimension_weights:
    决策: 20  # 决策维度权重
    过程: 25  # 过程维度权重
    产出: 30  # 产出维度权重
    效益: 25  # 效益维度权重
  
  # 一级指标定义（用于验证指标结构）
  level1_indicators:
    - "决策"
    - "过程" 
    - "产出"
    - "效益"

# =============================================================================
# 提示词配置 - 架构师专用提示词模板
# =============================================================================
prompts:
  # 架构师基础系统提示词
  architect_base_system: |
    你是绩效评价报告的架构师。你的目标是：
    1. 深入分析研究简报，提取项目核心信息
    2. 基于标准绩效评价框架设计报告结构
    3. 构建科学的指标体系，确保评价的全面性和准确性
  
  # RAG关键词生成提示词
  rag_keywords_generation: |
    你是架构师的RAG检索助手。基于以下项目信息，生成用于检索向量知识库的关键词组。
    
    项目信息：
    {project_info}
    
    请生成6个类别的检索关键词，每个类别包含3-5个具体的检索词：
    
    返回JSON格式：
    [
      {{
        "category": "项目背景与目标",
        "keywords": ["项目立项背景", "主要目标", "预期成果"]
      }},
      {{
        "category": "资金与预算",
        "keywords": ["预算总额", "资金来源", "资金分配"]
      }},
      {{
        "category": "实施方案",
        "keywords": ["实施步骤", "技术方案", "管理措施"]
      }},
      {{
        "category": "效果与成效",
        "keywords": ["实施效果", "产出指标", "效益分析"]
      }},
      {{
        "category": "政策依据",
        "keywords": ["政策文件", "法规依据", "标准规范"]
      }},
      {{
        "category": "风险与挑战",
        "keywords": ["存在问题", "风险因素", "改进建议"]
      }}
    ]
    
    要求：关键词要具体、准确，能在{project_name}相关资料中找到对应信息。

  # 章节提示词生成模板
  section_prompt_generation: |
    针对{project_name}，{base_prompt}
    
    ### 📋 具体写作指导与检索要求：
    
    {rag_instructions}
    
    ### 🔍 RAG检索策略：
    写作时请严格按照以下步骤进行：
    1. 首先检索上述关键信息项，获取具体数据和事实
    2. 基于检索到的真实信息进行分析和论述
    3. 避免泛泛而谈，确保每个论点都有具体的数据支撑
    4. 如果某项信息检索不到，明确标注"信息待补充"
    
    ### 📊 质量要求：
    - 数据准确：所有数字、时间、名称必须来自检索到的原始资料
    - 逻辑清晰：按照检索指导的顺序组织内容结构
    - 深度分析：不仅要列出事实，还要分析原因和影响

  # 指标体系设计提示词
  metrics_design: |
    你是绩效评价指标体系的架构师。请基于以下项目信息，设计一套完整的绩效评价指标体系。
    
    项目信息：
    {project_info}
    
    指标体系设计要求：
    1. 一级指标权重分配：决策(15分)、过程(25分)、产出(35分)、效益(25分)
    2. 每个一级指标下设置2-3个具体指标
    3. 每个指标必须选择一种评价类型，共6种可选：
      - "要素符合度计分": 根据符合的要素数量计分
      - "公式计算得分": 通过数学公式计算得分  
      - "条件判断得分": 根据是否满足条件计分
      - "定性与定量结合": 综合定性和定量评价
      - "递减扣分机制": 从满分开始根据问题扣分
      - "李克特量表法": 通过满意度调查计分
    
    请返回JSON格式，每个指标包含：
    - metric_id: 唯一标识（英文）
    - name: 指标名称（中文）
    - category: 指标分类
    - 一级指标: "决策"/"过程"/"产出"/"效益"
    - 二级指标: 具体的二级指标名称
    - 三级指标: 具体的三级指标名称
    - 分值: 该指标权重分值（与一级指标权重匹配）
    - evaluation_type: 评价类型（必须选择上述6种之一）
    - evaluation_points: 具体评价要点（数组格式，如["①立项符合法规","②符合规划"]）
    - scoring_method: 详细计分方式（如"具备一个要素得20%分值"）
    - 评分过程: Writer执行评价的具体指导
    
    ⚠️ 重要格式要求：
    - 所有字段名必须使用英文或中文，不能混用
    - scoring_method字段必须一致，不能使用"评分方法"或"scoring方法"
    - 确保JSON格式完全正确，所有字段都有值
    
    请为{project_name}（{project_type}）设计18-20个指标，确保：
    - 决策类指标总分值=15分
    - 过程类指标总分值=25分  
    - 产出类指标总分值=35分
    - 效益类指标总分值=25分
    - 每个指标都有明确的评价类型和详细评价要点
  # 研究类提示词（集中管理）
  research:
    comprehensive_research_base_system: |
      你是一名专业的AI研究分析师和产品经理。你的目标是：
      1. 深入理解用户需求和业务背景
      2. 进行全面的市场和案例研究
      3. 生成高质量的研究简报，为后续的架构设计和内容生成提供坚实基础

    research_topic_system: |
      你是一名AI研究分析师，你的研究主题是:
      #主题#
      {topic}

    search_keywords_prompt: |
      请根据你的研究主题，提供最多3个必要的关键词用于网络搜索。
      这些关键词应该能够帮助收集到最相关和最有价值的信息。
      你的回应必须是JSON格式，例如：["关键词1", "关键词2", "关键词3"]。

    decompose_research_prompt: |
      ### 要求
      1. 你的研究主题和初步搜索结果展示在"参考信息"部分。
      2. 请基于这些信息，生成最多 {decomposition_nums} 个与研究主题相关的、更具体的调查问题。
      3. 这些问题应该能够帮助深入了解主题的不同方面，包括市场趋势、最佳实践、技术方案等。
      4. 你的回应必须是JSON格式：["问题1", "问题2", "问题3", ...]。

      ### 参考信息
      {search_results}

    rank_urls_prompt: |
      ### 主题
      {topic}
      ### 具体问题
      {query}
      ### 原始搜索结果
      {results}
      ### 要求
      1) 先移除与具体问题或主题无关的搜索结果；
      2) 如果问题具有时效性，移除过时的信息。当前时间是 {time_stamp}；
      3) 域名白名单强约束：只保留以下来源（非白名单一律淘汰）：
         - 政府/部委官网与权威门户：*.gov.cn 以及各部委官方网站（如 henan.gov.cn czt.henan.gov.cn 等）
         - 权威机构/监管部门官方网站
         - 主流权威媒体与学术数据库（如新华社/人民日报等权威媒体、主流学术库）
      4) 在仅保留白名单后的结果中，再根据可信度和与问题的相关性进行排序；
      5) 仅以 JSON 数组输出排序后保留结果的索引，例如 [0, 1, 3]，禁止输出除数组外的任何文字。

    web_content_analysis_prompt: |
      ### 要求
      1. 利用"参考信息"中的文本来回答问题"{query}"。
      2. 如果无法直接回答，但内容与研究主题相关，请对文本进行全面总结。
      3. 如果内容完全不相关，请回复"不相关"。
      4. 重点提取：关键数据、统计信息、最佳实践、指标体系、政策法规等。

      ### 参考信息
      {content}
    
    #强化对“对标案例与指标体系”的专用抽取提示
    case_benchmarking_prompt: |
      目标：从相似项目/网络案例中抽取“指标体系+具体指标（评价要点/计分方法/实际评价意见）”用于对标。
      输入：{content}
      输出必须为JSON：
      {
        "similar_cases":[
          {
            "case_title":"...",
            "source_url":"...",
            "fit_reason":"...",
            "metric_system":[
              {
                "metric_id":"...","name":"...","category":"...","evaluation_type":"...",
                "evaluation_points":["①...","②..."],"scoring_method":"...",
                "sample_opinion":"来自文本的评价意见原文/摘要（如有）","evidence_ids":["..."]
              }
            ],
            "key_takeaways":["...","..."]
          }
        ]
      }

    generate_research_brief_prompt: |
      你的输出必须是JSON，严禁输出任何多余文本。键名严格为：
      ["meta","alignment","overview","conclusion","achievements","problems","suggestions","cases_and_benchmarks"]。

      引用来源的硬性约束（禁止编造与示例链接）：
      - allowed_web_urls: {allowed_web_urls}
      - allowed_project_docs: {allowed_project_docs}
      - 只允许引用上述白名单中的来源；不得出现 example.com 等非白名单域。
      - 来自 web 的证据必须引用 allowed_web_urls 内的某一条（source_type="web", source_url="<白名单URL>").
      - 来自项目文档的证据使用文件名（source_type="project_vector", file_path="<白名单文件名>").
      - 来自全局知识图谱的证据只允许使用关系/三元组引用（source_type="global_kg", kg_ref="<实体/关系描述>")，不得生成URL。
      - 如某处确无可引用证据，务必输出 "信息待补充"，绝不编造。

      研究过程覆盖六个阶段（融合向量库+全局KG+网络）：
      1) 项目建设初期的调研分析
      2) 项目总结阶段的全面梳理
      3) 寻找类似项目和网络案例
      4) 构建指标体系的前期研究
      5) 发现项目核心问题和要点
      6) 借鉴历史项目经验和内容

      输出结构示例（务必严格遵循；示例字段请替换为真实内容）：
      {
        "meta": {
          "topic": "{topic}",
          "generated_at": "{time_stamp}",
          "kb_sources": ["global_kg","project_vector","web"]
        },
        "alignment": {
          "stages": [
            {"id":"early_investigation","summary":"...","evidence_ids":["E01","E02"]},
            {"id":"final_review","summary":"...","evidence_ids":["E03"]},
            {"id":"find_cases","summary":"...","evidence_ids":["E10","E11"]},
            {"id":"metrics_research","summary":"...","evidence_ids":["E20"]},
            {"id":"core_issues","summary":"...","evidence_ids":["E30"]},
            {"id":"learn_history","summary":"...","evidence_ids":["E40"]}
          ],
          "metrics_recommendation": [
            {"category":"决策","name":"立项政策符合性","evaluation_type":"要素符合度计分","why":"...","evidence_ids":["E21"]}
          ],
          "policy_refs": [{"title":"...","clause":"...","why":"...","source_type":"web","source_url":"<必须在白名单>"}],
          "methods": [{"name":"AHP","steps":["..."],"use_for":"权重设定","source_type":"web","source_url":"<必须在白名单>"}]
        },
        "overview": {
          "summary":"...",
          "search_plan":["关键词1","关键词2"],
          "evidence":[
            {"id":"E01","type":"policy|method|case|metric|data",
             "quote":"...",
             "source_type":"web|project_vector|global_kg",
             "source_url":"<当source_type=web必填且在白名单>",
             "file_path":"<当source_type=project_vector必填且在白名单>",
             "kg_ref":"<当source_type=global_kg必填，不允许URL>"
            }
          ],
          "writing_points":["..."],
          "gaps":["..."]
        },
        "conclusion": { ... 同上 ... },
        "achievements": { ... 同上 ... },
        "problems": {
          "summary":"...",
          "focus_on_metric_penalties": true,
          "penalty_map":[
            {"metric_id":"process_fund_compliance","reason":"...","data_basis":["..."],"impact":"...","evidence_ids":["E31"]}
          ],
          "writing_points":["优先说明扣分原因→数据依据→影响范围→改进路径"]
        },
        "suggestions": { ... 同上 ... },
        "cases_and_benchmarks": {
          "similar_cases": [
            {
              "case_title":"...",
              "fit_reason":"与当前项目在[地区/类型/预算/目标]相似",
              "source_type":"web",
              "source_url":"<必须在白名单>",
              "metric_system":[
                {
                  "metric_id":"...",
                  "name":"...",
                  "category":"决策|过程|产出|效益",
                  "evaluation_type":"...",
                  "evaluation_points":["①...","②..."],
                  "scoring_method":"...",
                  "sample_opinion":"（真实评价意见/摘要）",
                  "evidence_ids":["E50","E51"]
                }
              ],
              "key_takeaways":["...","..."]
            }
          ]
        }
      }

  # 写作类提示词（集中管理）
  writer:
    writer_base_system: |
      你是绩效评价报告的写作专家。你的目标是：
      1. 基于事实依据和数据支撑，撰写高质量的报告章节
      2. 严格遵循架构师制定的写作指导和检索要求
      3. 确保内容专业、准确、深入，符合绩效评价报告的标准

    section_writing_prompt: |
      请根据以下信息撰写报告章节：

      ## 章节标题
      {section_title}

      ## 写作要求与指导
      {instruction}

      ## 相关事实依据（来自向量检索）
      {factual_basis}

      ## 关联的绩效指标
      {metrics_text}

      ## 📋 写作标准与质量要求

      ### 🎯 内容要求
      1. **数据驱动**: 所有论点必须基于上述事实依据，避免空泛论述
      2. **结构清晰**: 按照写作要求中的指导顺序组织内容
      3. **深度分析**: 不仅要列出事实，还要分析原因、影响和趋势
      4. **专业表达**: 使用绩效评价专业术语和商业分析语言

      ### 📊 格式要求
      1. **表格展示**: 涉及数据对比时，务必使用Markdown表格格式
      2. **分层论述**: 使用适当的标题层级组织内容结构
      3. **数据引用**: 明确标注数据来源和引用依据
      4. **字数控制**: 章节内容控制在{word_limit}字以内

      ### 🔍 检索验证要求
      - 如果事实依据中缺少某项关键信息，请明确标注"**信息待补充**"
      - 确保每个关键论点都有具体的数据或事实支撑
      - 避免使用模糊的表述，如"大约"、"可能"等

      请严格按照上述要求开始撰写：

    # 通用：指标评价提示词模板（用于所有评价类型）
    evaluation_prompt_template: |
      【格式硬性约束 - 仅输出JSON】
      - 你必须仅输出一个 JSON 对象，且键严格为：score(float) 与 opinion(string)。
      - 禁止输出任何额外文字、说明、Markdown、代码块围栏（```）或前后缀。
      - 若无法完全确定分数，也必须输出形如 {"score": 0, "opinion": "..."} 的JSON。

      请基于以下事实依据，对指标进行“{evaluation_type}”方式的专业评价与计分。

      【评价要点】
      {evaluation_points}

      【事实依据（RAG检索）】
      {facts}

      【评分方法】
      {scoring_method}

      【类型说明】
      {type_description}

      【评分指导】
      {scoring_guidance}

      【评价意见撰写要求】
      {opinion_requirements}

      请严格按照“{evaluation_type}”的规则执行，返回JSON：
      {{
        "score": 80.0,
        "opinion": "……不包含最终结论性措辞，仅呈现评价依据与过程。"
      }}

      【再次强调 - 仅输出JSON】
      - 最终回复只允许包含上述 JSON 对象；不得包含除 JSON 外的任何字符（包括换行说明、前置/后置文字、Markdown等）。
      - 如果事实依据不足，也必须输出合法 JSON，并在 opinion 中说明依据不足的原因。

    # 指标级提示词组合规范（控制评价要点与评分方法如何呈现）
    metric_prompt_spec:
      default:
        points_intro: "评价要点："
        point_bullet: "- "
        scoring_method_intro: "评分方法："
        max_points: 10
      by_evaluation_type:
        要素符合度计分:
          points_intro: "评价要素："
          point_bullet: "- "
          scoring_method_intro: "计分规则："
        公式计算得分:
          points_intro: "计算要求："
          point_bullet: "- "
          scoring_method_intro: "计算方法："
        条件判断得分:
          points_intro: "判断条件："
          point_bullet: "- "
          scoring_method_intro: "判定标准："
        定性与定量结合:
          points_intro: "评价要求："
          point_bullet: "- "
          scoring_method_intro: "权重与合成方法："
        递减扣分机制:
          points_intro: "扣分标准："
          point_bullet: "- "
          scoring_method_intro: "扣分方法："
        李克特量表法:
          points_intro: "调查要求："
          point_bullet: "- "
          scoring_method_intro: "得分计算方法："

    

# =============================================================================
# 评价类型定义 - 6种标准化评价类型
# =============================================================================
evaluation_types:
  要素符合度计分:
    description: "根据各项要素的符合情况进行计分"
    scoring_guidance: |
      要素符合度计分计算步骤：
      1. 从事实中识别符合的要素（如"符合评价要点①②"）
      2. 从规则中提取每个要素的分值
      3. 将符合要素的分值相加得到最终得分
      
      示例：事实"符合①②，不符合③"，规则"①②各30%，③40%"
      计算：30+30+0=60分
    opinion_requirements: |
      - 必须包含具体的法规引用、文件名称等详实内容
      - 明确列出每个评价要点的符合/不符合情况
      - 使用分号分隔各要点的评价
      - 不得包含任何最终得分或结论性语句

  公式计算得分:
    description: "通过特定公式计算得出分数"
    scoring_guidance: |
      公式计算得分步骤：
      1. 从规则中找到计算公式
      2. 从事实中提取数值
      3. 代入公式计算，结果换算到100分制
      
      示例：预算执行率=实际支出/预算金额×100%
      实际支出800万，预算1000万
      计算：800/1000×100%=80%，得80分
    opinion_requirements: |
      - 必须列出具体的计算数据和来源
      - 展示完整的计算公式和计算过程
      - 如有多年数据，需计算加权平均值
      - 百分比保留两位小数
      - 不得包含任何最终得分或结论性语句

  条件判断得分:
    description: "根据是否满足特定条件来计分"
    scoring_guidance: |
      条件判断得分步骤：
      1. 识别事实满足的条件档次
      2. 给予该档次对应的分数
      
      示例：条件"项目有完整预算"，事实"项目编制了详细预算"
      判断：满足条件，得100分
    opinion_requirements: |
      - 明确说明每个条件的满足/不满足情况
      - 提供具体的证据材料或事实依据
      - 对于不满足的条件，说明具体缺失什么
      - 不得包含任何最终得分或结论性语句

  定性与定量结合:
    description: "结合定性描述和定量数据进行评价"
    scoring_guidance: |
      定性与定量结合步骤：
      1. 分别计算定量和定性部分分数
      2. 按权重合并分数
      
      示例：定量部分（60%权重）：完成率90%，得90分
      定性部分（40%权重）：质量优秀，得95分
      综合得分：90×0.6+95×0.4=92分
    opinion_requirements: |
      - 定量部分：列出具体数据、百分比、金额等
      - 定性部分：描述实地调研、访谈等发现的情况
      - 两部分要有机结合，不能割裂
      - 对于部分达标的情况，明确扣分比例
      - 不得包含任何最终得分或结论性语句

  递减扣分机制:
    description: "从满分开始根据问题情况进行扣分"
    scoring_guidance: |
      递减扣分机制步骤：
      1. 从满分开始
      2. 根据问题数量扣分
      3. 计算最终剩余分数
      
      示例：满分100分，每个问题扣10分
      发现3个问题，扣30分
      最终得分：100-30=70分
    opinion_requirements: |
      - 列出发现的每个问题及具体表现
      - 说明每类问题的扣分标准
      - 问题要具体到时间、地点、责任主体
      - 不得包含任何最终得分或结论性语句

  李克特量表法:
    description: "通过调查问卷和统计分析计算满意度"
    scoring_guidance: |
      李克特量表法步骤：
      1. 根据满意度百分比对应分数档次
      2. 或直接将满意度百分比作为得分
      
      示例：满意度调查结果92.8%
      90%以上为优秀，得满分
      最终得分：100分
    opinion_requirements: |
      - 说明调查方法和样本量
      - 列出各满意度等级的具体人数
      - 展示满意度计算公式和过程
      - 满意度百分比保留两位小数
      - 不得包含任何最终得分或结论性语句

# =============================================================================
# 章节特定配置 - 替代硬编码的条件判断逻辑
# =============================================================================
section_configurations:
  # 🎯 章节配置：通过section key自动映射，不再需要硬编码条件判断
  overview:  # 项目概述
    title_keywords: ["项目概述", "概述"]  # 用于自动匹配章节标题
    keywords: ["项目背景与目标", "资金与预算", "实施方案", "效果与成效"]
    rag_instructions: |
      **1. 项目立项背景及目的**
         - 检索关键词：项目背景与目标相关信息
         - 重点查找：政策文件引用、立项依据、目标设定
         
      **2. 资金投入和使用情况**
         - 检索关键词：资金与预算相关信息
         - 重点查找：预算总额、资金来源、分配明细、执行进度
         
      **3. 项目组织管理**
         - 检索关键词：实施方案相关信息
         - 重点查找：管理机构、职责分工、流程制度
         
      **4. 项目绩效目标**
         - 检索关键词：效果与成效相关信息
         - 重点查找：绩效目标表、指标设定、预期成果（务必以表格形式展示）

  conclusion:  # 综合绩效评价结论
    title_keywords: ["综合绩效评价结论", "评价结论", "绩效结论"]
    keywords: ["效果与成效", "评价指标", "绩效得分"]
    rag_instructions: |
      **决策、过程、产出、效益四个维度分析**
         - 检索关键词：效果与成效相关信息
         - 重点查找：各项指标完成情况、评分结果、综合得分
         - 必须输出：指标得分情况表（一级指标、分值、得分、得分率）

  achievements:  # 主要成效及经验
    title_keywords: ["主要成效及经验", "成效", "经验"]
    keywords: ["效果与成效", "实施方案", "成功案例"]
    rag_instructions: |
      **具体成效数据**
         - 检索关键词：效果与成效相关信息
         - 重点查找：量化成果数据、受益人群统计、效果对比
         
      **成功经验总结**
         - 检索关键词：实施方案相关信息
         - 重点查找：创新做法、管理经验、技术亮点

  problems:  # 存在的问题和原因分析
    title_keywords: ["存在的问题和原因分析", "问题", "原因分析"]
    keywords: ["风险与挑战", "问题分析", "原因调查"]
    rag_instructions: |
      **问题识别**
         - 检索关键词：风险与挑战相关信息
         - 重点查找：调研发现的问题、数据反映的不足、反馈意见
         
      **原因深度分析**
         - 检索关键词：政策执行、管理制度、技术条件、外部环境
         - 重点查找：问题产生的内在机制和外部因素

  suggestions:  # 改进建议
    title_keywords: ["改进建议", "建议"]
    keywords: ["改进措施", "最佳实践", "政策建议"]
    rag_instructions: |
      **针对性建议**
         - 基于前述问题分析，检索关键词：风险与挑战相关信息
         - 重点查找：改进措施、政策建议、技术优化方案
         
      **可操作性验证**
         - 检索关键词：成功案例、最佳实践、政策支持
         - 重点查找：类似项目的改进经验、政策可行性分析

  # 🎯 通用章节配置 - 作为备用
  general:
    title_keywords: ["其他", "通用"]
    keywords: ["项目相关信息"]
    rag_instructions: |
      **通用检索指导**
         - 优先检索：项目相关的具体数据、政策文件、实施效果
         - 重点关注：数量化指标、时间节点、责任主体、具体措施

# =============================================================================
# 智能检索配置 - 用于智能检索服务,包含知识图谱细节
# =============================================================================
intelligent_search:
  # 查询意图分析配置（按优先级保序：reasoning > policy > method > case > metric > performance）
  query_intent_mapping:
    reasoning: ["因果","关系","推理","证据链","三元组","图谱","关联推断","路径","上下游","链路"]
    policy: ["政策","法规","法条","条款","规范","标准","办法","通知","指导意见","依据"]
    method: ["方法","模型","步骤","流程","算法","框架","AHP","评价方法"]
    case: ["案例","实践","复盘","经验","对标","标杆"]
    metric: ["指标","指标体系","KPI","KRI","评价点","评分方法"]
    performance: ["绩效评价","评分规则","计分方法","评价标准","权重设定"]
  
  # 检索模式权重配置
  search_mode_weights:
    vector: 0.6      # 向量检索权重
    knowledge_graph: 0.4  # 知识图谱权重

  top_k:
    global_top_k: 4  #智能检索intelligent_search 参数,调低提高性能
    project_top_k: 2

  knowledge_graph:
    max_keywords: 5   # KG最多取前5个关键词
    # 增强后再次限词（新增）：避免增强上下文带来过多关键词
    limit_keywords_after_enhance: true
    max_keywords_after_enhance: 5

  # KG 档位配置（按意图选择检索强度）
  kg_profiles:
    reasoning:
      retriever_mode: "embedding"
      response_mode: "tree_summarize"
      similarity_top_k: 8
    policy:
      retriever_mode: "keyword"
      response_mode: "tree_summarize"
      similarity_top_k: 8
    method:
      retriever_mode: "embedding"
      response_mode: "compact"
      similarity_top_k: 6
    case:
      retriever_mode: "embedding"
      response_mode: "compact"
      similarity_top_k: 6
    metric:
      retriever_mode: "embedding"
      response_mode: "compact"
      similarity_top_k: 6
    performance:
      retriever_mode: "embedding"
      response_mode: "compact"
      similarity_top_k: 6

  # URL 白名单（用于排序与程序化回退）
  url_whitelist:
    suffix:
      - ".gov.cn"
      - ".edu.cn"
    hosts:
      - "henan.gov.cn"
      - "czt.henan.gov.cn"
      - "ggzyjy.shangqiu.gov.cn"
      - "ccgp-henan.gov.cn"



llm_limits:
    max_input_tokens: 120000