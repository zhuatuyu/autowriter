# AutoWriter Enhanced - 虚拟AI办公室

AutoWriter Enhanced 是一个基于**MetaGPT框架**和**Orchestrator模式**的虚拟AI办公室系统，通过模拟真实办公室的岗位分工来实现智能化的报告写作。

## 核心理念：MetaGPT对齐的虚拟办公环境

系统设计完全基于MetaGPT框架的最佳实践，采用**Orchestrator模式**实现多智能体协作：

### 🏢 虚拟办公室团队
- **🎯 智能项目总监（DirectorAgent）**：项目经理，负责规划和客户沟通
- **📄 文档专家（DocumentExpertAgent）**：办公室文秘，负责文档管理和格式化
- **🔍 案例专家（CaseExpertAgent）**：研究员，负责案例搜索和分析
- **📊 数据分析师（DataAnalystAgent）**：数据专家，负责统计分析和可视化
- **✍️ 写作专家（WriterExpertAgent）**：内容创作者，负责报告撰写

## 核心特性

### 🤖 MetaGPT对齐的智能协作
- **标准Role设计**：所有Agent继承自MetaGPT的Role基类
- **Action机制**：使用MetaGPT的Action实现原子化操作
- **Orchestrator模式**：状态机驱动的协调器，管理多智能体协作
- **职责分离**：Director只负责规划，Orchestrator只负责协调，Expert只负责执行

### 📊 状态机驱动的用户交互
- **明确状态管理**：IDLE, PLANNING, AWAITING_USER_APPROVAL, EXECUTING, COMPLETED, ERROR
- **状态分发器**：基于当前状态智能分发用户消息
- **原子操作**：将复杂逻辑拆分为可复用的原子操作
- **错误恢复**：完整的错误处理和状态恢复机制

### 📄 专业文档处理
- **多格式支持**：PDF、Word、Excel等格式自动转换为Markdown
- **MinerU API集成**：专业的文档处理能力
- **智能摘要**：自动提取关键信息和生成摘要
- **文档索引**：建立完整的文档管理体系

### 🔍 智能内容生成
- **案例搜索**：自动搜索相关案例和最佳实践
- **数据分析**：从文档中提取和分析数据
- **内容整合**：将多源信息整合为连贯的报告
- **质量把控**：多层次的内容审核和润色

## 架构优势

### 🎯 MetaGPT对齐优势
- **标准化设计**：完全遵循MetaGPT的Role-Action-Tool-Skill架构
- **可扩展性强**：基于MetaGPT框架，易于添加新的Agent和功能
- **代码复用**：利用MetaGPT的成熟组件，避免重复造轮子
- **最佳实践**：采用MetaGPT推荐的设计模式和开发规范

### 💼 Orchestrator模式优势
- **职责单一**：每个组件都有明确的职责边界
- **状态明确**：通过状态机管理，系统行为可预测
- **高度灵活**：交互流程完全解耦，可轻松修改
- **易于维护**：清晰的架构层次，便于调试和扩展

### 🛠️ 技术优势
- **实时协作**：WebSocket实现真正的实时交互
- **稳定架构**：核心基础设施与业务逻辑分离
- **AI集成**：深度集成MetaGPT和各种AI服务
- **文档处理**：专业的多格式文档处理能力

## 目标用户

- **政府机构**：绩效评价报告、政策分析报告
- **企业组织**：评估文档、分析报告
- **研究机构**：调研报告、数据分析报告
- **咨询公司**：客户报告、项目评估

## 使用场景

### 典型工作流程
1. **需求沟通**：项目总监与客户对话，明确报告需求
2. **计划生成**：Director生成结构化的执行计划
3. **用户确认**：用户审阅并确认计划
4. **任务执行**：Orchestrator协调各Expert执行任务
5. **结果交付**：整合各Expert的工作成果
6. **质量审核**：进行最终审核和润色

### 特色功能
- **智能计划生成**：基于用户需求自动生成可执行的SOP计划
- **状态可视化**：实时显示系统状态和任务进度
- **灵活需求调整**：随时调整需求，AI团队自动适应
- **质量层层把关**：从数据到内容到格式的全方位质量控制

## 技术架构

### 后端架构
- **FastAPI**：高性能异步Web框架
- **MetaGPT**：多智能体协作框架
- **WebSocket**：实时通信
- **状态机**：会话状态管理

### 前端架构
- **React 18 + TypeScript**：现代化前端框架
- **Tailwind CSS**：响应式设计
- **Zustand**：状态管理
- **WebSocket**：实时通信

## 部署和配置

### 环境要求
- Python 3.8+
- Node.js 16+
- MetaGPT框架
- MinerU API密钥

### 配置文件
- `MetaGPT/config/config2.yaml` - MetaGPT配置
- 环境变量中配置MinerU API密钥

## 总结

AutoWriter Enhanced 不仅仅是一个报告生成工具，更是一个完整的**MetaGPT对齐的虚拟AI办公室**，为用户提供专业、高效、可靠的报告写作服务。通过Orchestrator模式和状态机管理，系统实现了真正的智能协作，为用户带来前所未有的AI办公体验。